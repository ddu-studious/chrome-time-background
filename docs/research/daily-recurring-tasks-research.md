# é•¿æœŸä»»åŠ¡/æ¯æ—¥é‡å¤ä»»åŠ¡å±•ç¤ºå½¢å¼è°ƒç ”æŠ¥å‘Š

> **è°ƒç ”æ—¥æœŸ**: 2026-02-07  
> **é¡¹ç›®**: ä¸­å›½é£æ™¯æ—¶é’Ÿ Chrome æ‰©å±• - ä»»åŠ¡ç®¡ç†ç³»ç»Ÿ  
> **è°ƒç ”ç›®æ ‡**: ä¸º"é•¿æœŸä»»åŠ¡/æ¯æ—¥é‡å¤ä»»åŠ¡"åŠŸèƒ½è®¾è®¡æœ€ä½³å±•ç¤ºå½¢å¼

---

## ä¸€ã€è¡Œä¸šè°ƒç ”æ€»ç»“

### 1.1 ä¸»æµä»»åŠ¡ç®¡ç†å·¥å…·çš„å¤„ç†æ–¹å¼

#### Todoist
- **é‡å¤ä»»åŠ¡è®¾ç½®**: æä¾›å¯è§†åŒ–ç•Œé¢è®¾ç½®é‡å¤æ¨¡å¼ï¼ˆæ¯æ—¥ã€æ¯å‘¨ã€æ¯æœˆç­‰ï¼‰ï¼Œæ”¯æŒè‡ªå®šä¹‰é—´éš”
- **å±•ç¤ºæ–¹å¼**: é‡å¤ä»»åŠ¡åœ¨åˆ°æœŸæ—¥è‡ªåŠ¨å‡ºç°åœ¨"ä»Šæ—¥"è§†å›¾ï¼Œæ˜¾ç¤ºé‡å¤å›¾æ ‡ï¼ˆğŸ”„ï¼‰
- **ç‰¹ç‚¹**: æ–°å®ä¾‹åœ¨å®Œæˆå‰ä¸€ä¸ªä»»åŠ¡åè‡ªåŠ¨ç”Ÿæˆï¼Œæˆ–æŒ‰å›ºå®šæ—¶é—´è¡¨ç”Ÿæˆ
- **UIè®¾è®¡**: ç®€æ´çš„é‡å¤å›¾æ ‡æ ‡è¯†ï¼Œä¸å ç”¨è¿‡å¤šè§†è§‰ç©ºé—´

#### TickTick
- **ä¹ æƒ¯è¿½è¸ª**: ä¸“é—¨çš„ä¹ æƒ¯è¿½è¸ªæ¨¡å—ï¼Œæ”¯æŒæ¯æ—¥æ‰“å¡
- **å±•ç¤ºæ–¹å¼**: 
  - ä¹ æƒ¯ä»»åŠ¡æ˜¾ç¤ºåœ¨ä¸“é—¨çš„"ä¹ æƒ¯"åŒºåŸŸ
  - æ—¥å†è§†å›¾æ˜¾ç¤ºå®Œæˆæƒ…å†µï¼ˆçƒ­åŠ›å›¾ï¼‰
  - ç»Ÿè®¡é¢æ¿æ˜¾ç¤ºè¿ç»­å¤©æ•°ã€å®Œæˆç‡
- **ç‰¹ç‚¹**: ä¹ æƒ¯ä»»åŠ¡ä¸æ™®é€šä»»åŠ¡åˆ†ç¦»ï¼Œæœ‰ç‹¬ç«‹çš„ç»Ÿè®¡å’Œå¯è§†åŒ–

#### Microsoft To Do
- **æ¯æ—¥ä¹ æƒ¯**: æ”¯æŒåˆ›å»ºæ¯æ—¥é‡å¤ä»»åŠ¡
- **å±•ç¤ºæ–¹å¼**: åœ¨"æˆ‘çš„ä¸€å¤©"è§†å›¾ä¸­æ˜¾ç¤ºï¼Œæ ‡è®°ä¸ºé‡å¤ä»»åŠ¡
- **ç‰¹ç‚¹**: ç®€å•ç›´æ¥ï¼Œä¸æ™®é€šä»»åŠ¡æ··æ’ä½†å¸¦æœ‰é‡å¤æ ‡è¯†

#### Things 3
- **é‡å¤æ¨¡å¼**: 
  - å›ºå®šæ—¶é—´è¡¨ï¼šæŒ‰å›ºå®šé—´éš”é‡å¤
  - å®Œæˆåé‡å¤ï¼šå®Œæˆå‰ä¸€ä¸ªä»»åŠ¡åç”Ÿæˆæ–°å®ä¾‹
  - å·¥ä½œæ—¥é‡å¤ï¼šä»…åœ¨å·¥ä½œæ—¥é‡å¤
- **å±•ç¤ºæ–¹å¼**: é‡å¤ä»»åŠ¡è‡ªåŠ¨å‡ºç°åœ¨"ä»Šæ—¥"è§†å›¾ï¼Œä¸æ—¥å†äº‹ä»¶ä¸€èµ·æ˜¾ç¤º
- **UIè®¾è®¡**: é‡å¤ä»»åŠ¡å¸¦æœ‰ç‰¹æ®Šæ ‡è¯†ï¼Œæ”¯æŒè®¾ç½®æé†’å’Œæˆªæ­¢æ—¶é—´

#### Habitica
- **æ¸¸æˆåŒ–ä¹ æƒ¯è¿½è¸ª**: å°†ä¹ æƒ¯ä»»åŠ¡æ¸¸æˆåŒ–
- **å±•ç¤ºæ–¹å¼**: 
  - ä¹ æƒ¯ä»»åŠ¡æ˜¾ç¤ºä¸ºå¯é‡å¤å®Œæˆçš„å¡ç‰‡
  - æ˜¾ç¤ºè¿ç»­å®Œæˆå¤©æ•°ï¼ˆStreakï¼‰
  - å®Œæˆæ—¶ç»™äºˆç»éªŒå€¼å’Œå¥–åŠ±
- **ç‰¹ç‚¹**: é€šè¿‡æ¸¸æˆåŒ–æœºåˆ¶å¢å¼ºç”¨æˆ·å®Œæˆä¹ æƒ¯çš„åŠ¨åŠ›

#### Streaks
- **æ ¸å¿ƒæœºåˆ¶**: "ä¸è¦æ‰“ç ´é“¾æ¡"ï¼ˆDon't break the chainï¼‰
- **å±•ç¤ºæ–¹å¼**: 
  - å¤§å›¾æ ‡ + è¿›åº¦ç¯æ˜¾ç¤º
  - æ—¥å†çƒ­åŠ›å›¾æ˜¾ç¤ºå®Œæˆå†å²
  - è¿ç»­å¤©æ•°å¾½ç« 
- **ç‰¹ç‚¹**: ä¸“æ³¨äºä¹ æƒ¯è¿½è¸ªï¼Œè§†è§‰åé¦ˆå¼ºçƒˆ

#### Google Tasks
- **é‡å¤è®¾ç½®**: æ”¯æŒæ¯æ—¥ã€æ¯å‘¨ã€æ¯æœˆã€æ¯å¹´é‡å¤
- **å±•ç¤ºæ–¹å¼**: é‡å¤ä»»åŠ¡åœ¨æ—¥å†è§†å›¾ä¸­æ˜¾ç¤ºï¼Œå¸¦æœ‰é‡å¤å›¾æ ‡
- **é™åˆ¶**: å…±äº«ä»»åŠ¡å’Œå­ä»»åŠ¡ä¸èƒ½é‡å¤

### 1.2 GitHub å¼€æºé¡¹ç›®å®ç°æ–¹å¼

#### Habitboard
- **å±•ç¤ºæ–¹å¼**: å‘¨è§†å›¾ï¼Œæ¯è¡Œä»£è¡¨ä¸€å‘¨ï¼Œ7ä¸ªæ ¼å­ä»£è¡¨7å¤©
- **æ•°æ®ç»“æ„**: ä½¿ç”¨ `localStorage` å­˜å‚¨ï¼Œæ”¯æŒå¤šä¸ªçœ‹æ¿
- **ç‰¹ç‚¹**: æç®€è®¾è®¡ï¼Œä¸“æ³¨äºä¹ æƒ¯æ‰“å¡ï¼Œæ— é™æ»šåŠ¨åŠ è½½å†å²å‘¨

#### Simple-Todo (Chrome Extension)
- **å±•ç¤ºæ–¹å¼**: ç®€å•çš„ä»»åŠ¡åˆ—è¡¨ï¼Œæ”¯æŒæ ‡ç­¾åˆ†ç±»
- **ç‰¹ç‚¹**: è½»é‡çº§ï¼Œé€‚åˆæ–°æ ‡ç­¾é¡µå¿«é€ŸæŸ¥çœ‹

#### todo.txt-recurring-tasks
- **å®ç°æ–¹å¼**: é€šè¿‡é…ç½®æ–‡ä»¶ç®¡ç†é‡å¤è§„åˆ™ï¼Œä½¿ç”¨ cron è‡ªåŠ¨ç”Ÿæˆæ–°ä»»åŠ¡
- **ç‰¹ç‚¹**: å‘½ä»¤è¡Œå·¥å…·ï¼Œé€‚åˆæŠ€æœ¯ç”¨æˆ·

### 1.3 Chrome æ‰©å±•æ¡ˆä¾‹

#### Everyday - Daily Habits & Productivity
- **åŠŸèƒ½**: æ–°æ ‡ç­¾é¡µ + ä¹ æƒ¯è¿½è¸ª + ä¹¦ç­¾ç®¡ç†
- **å±•ç¤ºæ–¹å¼**: æ¯æ—¥ä»»åŠ¡åˆ—è¡¨ï¼Œè‡ªåŠ¨æ‰“å¼€ç½‘ç«™ç»Ÿè®¡
- **ç‰¹ç‚¹**: ç»“åˆæ–°æ ‡ç­¾é¡µåœºæ™¯ï¼Œæä¾›ä¸€ç«™å¼ç”Ÿäº§åŠ›å·¥å…·

#### New Tab Todo List
- **åŠŸèƒ½**: åŠŸèƒ½ä¸°å¯Œçš„å¾…åŠåˆ—è¡¨
- **å±•ç¤ºæ–¹å¼**: æ”¯æŒåµŒå¥—åˆ—è¡¨ã€æ ‡ç­¾ã€å®æ—¶åä½œ
- **ç‰¹ç‚¹**: åŠŸèƒ½å…¨é¢ï¼Œä½†å¯èƒ½è¿‡äºå¤æ‚

### 1.4 æ ¸å¿ƒè®¾è®¡æ¨¡å¼æ€»ç»“

| è®¾è®¡æ¨¡å¼ | ä»£è¡¨äº§å“ | é€‚ç”¨åœºæ™¯ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|---------|---------|---------|------|------|
| **æ··æ’å±•ç¤º** | Todoist, Microsoft To Do | ä»»åŠ¡å’Œä¹ æƒ¯ç»Ÿä¸€ç®¡ç† | ç®€å•ç»Ÿä¸€ï¼Œæ— éœ€åˆ‡æ¢è§†å›¾ | ä¹ æƒ¯ä»»åŠ¡å¯èƒ½è¢«æ™®é€šä»»åŠ¡æ·¹æ²¡ |
| **ç‹¬ç«‹æ¨¡å—** | TickTick, Habitica | ä¹ æƒ¯è¿½è¸ªæ˜¯æ ¸å¿ƒåŠŸèƒ½ | ä¸“æ³¨åº¦é«˜ï¼Œç»Ÿè®¡ä¸°å¯Œ | éœ€è¦é¢å¤–çš„UIç©ºé—´ |
| **æ—¥å†çƒ­åŠ›å›¾** | Streaks, TickTick | é•¿æœŸä¹ æƒ¯è¿½è¸ª | è§†è§‰åŒ–å¼ºï¼Œå†å²ä¸€ç›®äº†ç„¶ | å ç”¨ç©ºé—´å¤§ |
| **å‘¨è§†å›¾ç½‘æ ¼** | Habitboard | æç®€ä¹ æƒ¯è¿½è¸ª | ç®€æ´ç›´è§‚ï¼Œæ˜“äºæ‰“å¡ | ä¸é€‚åˆå¤æ‚ä»»åŠ¡ |
| **æ¸¸æˆåŒ–** | Habitica | éœ€è¦æ¿€åŠ±çš„ç”¨æˆ· | è¶£å‘³æ€§å¼ºï¼Œæé«˜å®Œæˆç‡ | å¯èƒ½åˆ†æ•£æ³¨æ„åŠ› |

---

## äºŒã€Demo æ–¹æ¡ˆè®¾è®¡

### æ–¹æ¡ˆä¸€ï¼šæ··æ’å±•ç¤º + é‡å¤æ ‡è¯†ï¼ˆæ¨èåº¦ï¼šâ­â­â­â­ï¼‰

#### æ–¹æ¡ˆåç§°
**"ç»Ÿä¸€åˆ—è¡¨ + è§†è§‰æ ‡è¯†"æ–¹æ¡ˆ**

#### è®¾è®¡æè¿°
åœ¨ç°æœ‰ä¾§è¾¹æ ä»»åŠ¡åˆ—è¡¨ä¸­ï¼Œä¸ºé‡å¤ä»»åŠ¡æ·»åŠ è§†è§‰æ ‡è¯†å’Œç‰¹æ®Šæ ·å¼ã€‚é‡å¤ä»»åŠ¡ä¸æ™®é€šä»»åŠ¡æ··æ’ï¼Œä½†é€šè¿‡å›¾æ ‡ã€é¢œè‰²ã€å¾½ç« ç­‰æ–¹å¼çªå‡ºæ˜¾ç¤ºã€‚æ¯æ—¥é‡å¤ä»»åŠ¡æ¯å¤©è‡ªåŠ¨å‡ºç°åœ¨åˆ—è¡¨ä¸­ï¼Œé•¿æœŸä»»åŠ¡å§‹ç»ˆæ˜¾ç¤ºåœ¨é¡¶éƒ¨æˆ–ç‰¹æ®ŠåŒºåŸŸã€‚

#### æ•°æ®ç»“æ„è®¾è®¡

```javascript
// æ‰©å±•ç°æœ‰ä»»åŠ¡æ•°æ®ç»“æ„
{
    id: 'task_001',
    title: 'æ¯æ—¥æ™¨è·‘',
    text: 'è·‘æ­¥30åˆ†é’Ÿ',
    completed: false,
    createdAt: 1706601600000,
    updatedAt: 1706601600000,
    completedAt: null,
    categoryId: 'health',
    tagIds: [],
    priority: 'high',
    dueDate: '2026-02-07',  // å½“å‰æ—¥æœŸï¼ˆæ¯æ—¥æ›´æ–°ï¼‰
    images: [],
    progress: null,
    
    // æ–°å¢ï¼šé‡å¤ä»»åŠ¡é…ç½®
    recurrence: {
        enabled: true,
        type: 'daily',  // 'daily' | 'weekly' | 'monthly' | 'custom' | 'none'
        interval: 1,     // é—´éš”å¤©æ•°ï¼ˆdailyæ—¶å›ºå®šä¸º1ï¼‰
        weekDays: null, // [1,2,3,4,5] å‘¨ä¸€åˆ°å‘¨äº”ï¼ˆweeklyæ—¶ä½¿ç”¨ï¼‰
        monthDay: null, // 15 æ¯æœˆ15å·ï¼ˆmonthlyæ—¶ä½¿ç”¨ï¼‰
        endDate: null,  // '2026-12-31' ç»“æŸæ—¥æœŸï¼Œnullè¡¨ç¤ºæ— ç»“æŸ
        autoComplete: false  // æ˜¯å¦è‡ªåŠ¨å®Œæˆå‰ä¸€å¤©çš„ä»»åŠ¡
    },
    
    // æ–°å¢ï¼šä¹ æƒ¯è¿½è¸ªæ•°æ®ï¼ˆä»…dailyç±»å‹ï¼‰
    habit: {
        streak: 7,              // å½“å‰è¿ç»­å¤©æ•°
        bestStreak: 14,         // æœ€ä½³è¿ç»­å¤©æ•°
        completedDates: [       // å®Œæˆæ—¥æœŸæ•°ç»„
            '2026-02-01',
            '2026-02-02',
            '2026-02-03'
        ],
        totalCompletions: 45    // æ€»å®Œæˆæ¬¡æ•°
    },
    
    // æ–°å¢ï¼šé•¿æœŸä»»åŠ¡é…ç½®
    longTerm: {
        enabled: false,
        startDate: null,        // å¼€å§‹æ—¥æœŸ
        targetDate: null,       // ç›®æ ‡æ—¥æœŸ
        milestones: []          // é‡Œç¨‹ç¢‘æ•°ç»„
    }
}
```

#### UI æ¸²æŸ“ä»£ç 

**HTML ç»“æ„**:
```html
<!-- ä¾§è¾¹æ ä»»åŠ¡é¡¹ï¼ˆæ‰©å±•ç°æœ‰ç»“æ„ï¼‰ -->
<div class="sidebar-task-item recurring-task daily-task" data-id="task_001">
    <!-- é‡å¤ä»»åŠ¡æ ‡è¯† -->
    <div class="task-recurrence-badge">
        <i class="fas fa-redo"></i>
        <span class="recurrence-label">æ¯æ—¥</span>
    </div>
    
    <!-- ä¹ æƒ¯è¿½è¸ªå¾½ç« ï¼ˆä»…dailyç±»å‹æ˜¾ç¤ºï¼‰ -->
    <div class="task-habit-badge">
        <span class="streak-count">ğŸ”¥ 7</span>
        <span class="streak-label">è¿ç»­</span>
    </div>
    
    <!-- åŸæœ‰ä»»åŠ¡å†…å®¹ -->
    <div class="task-checkbox">
        <i class="far fa-circle"></i>
    </div>
    <div class="task-body">
        <div class="task-header">
            <span class="task-index">1</span>
            <span class="task-title">æ¯æ—¥æ™¨è·‘</span>
        </div>
        <div class="task-desc">è·‘æ­¥30åˆ†é’Ÿ</div>
        
        <!-- ä¹ æƒ¯ç»Ÿè®¡ï¼ˆå±•å¼€æ—¶æ˜¾ç¤ºï¼‰ -->
        <div class="task-habit-stats">
            <div class="stat-item">
                <span class="stat-label">æ€»å®Œæˆ:</span>
                <span class="stat-value">45æ¬¡</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">æœ€ä½³:</span>
                <span class="stat-value">14å¤©</span>
            </div>
        </div>
    </div>
</div>
```

**CSS æ ·å¼**:
```css
/* é‡å¤ä»»åŠ¡åŸºç¡€æ ·å¼ */
.sidebar-task-item.recurring-task {
    position: relative;
    border-left: 3px solid #64b5f6; /* è“è‰²æ ‡è¯† */
    background: linear-gradient(
        135deg,
        rgba(100, 181, 246, 0.08) 0%,
        rgba(255, 255, 255, 0.02) 100%
    );
}

/* æ¯æ—¥é‡å¤ä»»åŠ¡ç‰¹æ®Šæ ·å¼ */
.sidebar-task-item.daily-task {
    border-left-color: #4caf50; /* ç»¿è‰² */
}

/* é‡å¤ä»»åŠ¡æ ‡è¯† */
.task-recurrence-badge {
    position: absolute;
    top: 8px;
    right: 8px;
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 4px 8px;
    background: rgba(100, 181, 246, 0.2);
    border-radius: 12px;
    font-size: 11px;
    color: rgba(100, 181, 246, 0.9);
}

.task-recurrence-badge i {
    font-size: 10px;
    animation: rotate 2s linear infinite;
}

@keyframes rotate {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.recurrence-label {
    font-weight: 500;
}

/* ä¹ æƒ¯è¿½è¸ªå¾½ç«  */
.task-habit-badge {
    position: absolute;
    top: 8px;
    right: 80px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
    padding: 6px 10px;
    background: linear-gradient(135deg, #ff6b6b, #ff8e53);
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(255, 107, 107, 0.3);
}

.streak-count {
    font-size: 14px;
    font-weight: 700;
    color: white;
    line-height: 1;
}

.streak-label {
    font-size: 9px;
    color: rgba(255, 255, 255, 0.9);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* ä¹ æƒ¯ç»Ÿè®¡é¢æ¿ */
.task-habit-stats {
    display: flex;
    gap: 16px;
    margin-top: 8px;
    padding: 8px 12px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 6px;
    font-size: 12px;
}

.stat-item {
    display: flex;
    gap: 4px;
}

.stat-label {
    color: rgba(255, 255, 255, 0.6);
}

.stat-value {
    color: rgba(255, 255, 255, 0.9);
    font-weight: 600;
}

/* é•¿æœŸä»»åŠ¡æ ·å¼ */
.sidebar-task-item.long-term-task {
    border-left-color: #9c27b0; /* ç´«è‰² */
    background: linear-gradient(
        135deg,
        rgba(156, 39, 176, 0.08) 0%,
        rgba(255, 255, 255, 0.02) 100%
    );
}

.long-term-task .task-title::after {
    content: 'ğŸ“…';
    margin-left: 6px;
    opacity: 0.7;
}
```

**JavaScript æ¸²æŸ“é€»è¾‘**:
```javascript
/**
 * åˆ›å»ºé‡å¤ä»»åŠ¡é¡¹ï¼ˆæ‰©å±•ç°æœ‰ createSidebarTaskItem æ–¹æ³•ï¼‰
 */
createRecurringTaskItem(task, index, total) {
    const item = this.createSidebarTaskItem(task, index, total);
    
    // æ·»åŠ é‡å¤ä»»åŠ¡ç±»
    if (task.recurrence && task.recurrence.enabled) {
        item.classList.add('recurring-task');
        
        // æ ¹æ®é‡å¤ç±»å‹æ·»åŠ å…·ä½“ç±»
        if (task.recurrence.type === 'daily') {
            item.classList.add('daily-task');
            this.addHabitBadge(item, task);
        } else if (task.recurrence.type === 'weekly') {
            item.classList.add('weekly-task');
        } else if (task.recurrence.type === 'monthly') {
            item.classList.add('monthly-task');
        }
        
        // æ·»åŠ é‡å¤æ ‡è¯†
        this.addRecurrenceBadge(item, task.recurrence);
    }
    
    // é•¿æœŸä»»åŠ¡æ ‡è¯†
    if (task.longTerm && task.longTerm.enabled) {
        item.classList.add('long-term-task');
    }
    
    return item;
}

/**
 * æ·»åŠ é‡å¤æ ‡è¯†å¾½ç« 
 */
addRecurrenceBadge(item, recurrence) {
    const badge = document.createElement('div');
    badge.className = 'task-recurrence-badge';
    
    const labels = {
        daily: 'æ¯æ—¥',
        weekly: 'æ¯å‘¨',
        monthly: 'æ¯æœˆ',
        custom: 'è‡ªå®šä¹‰'
    };
    
    badge.innerHTML = `
        <i class="fas fa-redo"></i>
        <span class="recurrence-label">${labels[recurrence.type] || 'é‡å¤'}</span>
    `;
    
    item.appendChild(badge);
}

/**
 * æ·»åŠ ä¹ æƒ¯è¿½è¸ªå¾½ç« ï¼ˆä»…dailyç±»å‹ï¼‰
 */
addHabitBadge(item, task) {
    if (!task.habit) return;
    
    const badge = document.createElement('div');
    badge.className = 'task-habit-badge';
    badge.innerHTML = `
        <span class="streak-count">ğŸ”¥ ${task.habit.streak}</span>
        <span class="streak-label">è¿ç»­</span>
    `;
    
    // ç‚¹å‡»æ˜¾ç¤ºè¯¦ç»†ç»Ÿè®¡
    badge.addEventListener('click', (e) => {
        e.stopPropagation();
        this.showHabitStats(task);
    });
    
    item.appendChild(badge);
}

/**
 * æ£€æŸ¥å¹¶æ›´æ–°æ¯æ—¥é‡å¤ä»»åŠ¡
 */
async updateDailyRecurringTasks() {
    const today = this.getTodayDate();
    
    for (const task of this.memos) {
        if (!task.recurrence || !task.recurrence.enabled) continue;
        
        if (task.recurrence.type === 'daily') {
            // æ£€æŸ¥ä»Šå¤©æ˜¯å¦å·²å®Œæˆ
            const todayCompleted = task.habit?.completedDates?.includes(today);
            
            // å¦‚æœæ˜¨å¤©æœªå®Œæˆä¸”è®¾ç½®äº†è‡ªåŠ¨å®Œæˆï¼Œæ ‡è®°ä¸ºå®Œæˆ
            if (task.recurrence.autoComplete && !todayCompleted) {
                const yesterday = this.getDateString(new Date(Date.now() - 86400000));
                if (!task.habit.completedDates.includes(yesterday)) {
                    // è‡ªåŠ¨å®Œæˆæ˜¨å¤©çš„ä»»åŠ¡
                    await this.completeTask(task.id, yesterday);
                }
            }
            
            // ç¡®ä¿ä»Šå¤©çš„ä»»åŠ¡å­˜åœ¨
            if (task.dueDate !== today) {
                task.dueDate = today;
                task.completed = false;
                await this.saveTask(task);
            }
        }
    }
    
    this.renderSidebarContent();
}
```

#### ä¼˜ç¼ºç‚¹åˆ†æ

**ä¼˜ç‚¹**:
- âœ… ä¸ç°æœ‰ç³»ç»Ÿæ— ç¼é›†æˆï¼Œæ— éœ€å¤§å¹…æ”¹åŠ¨
- âœ… ç”¨æˆ·ä¹ æƒ¯ä¸€è‡´ï¼Œå­¦ä¹ æˆæœ¬ä½
- âœ… è§†è§‰æ ‡è¯†æ¸…æ™°ï¼Œæ˜“äºè¯†åˆ«é‡å¤ä»»åŠ¡
- âœ… ä¹ æƒ¯è¿½è¸ªå¾½ç« æä¾›å³æ—¶åé¦ˆ
- âœ… å®ç°ç®€å•ï¼Œå¼€å‘æˆæœ¬ä½

**ç¼ºç‚¹**:
- âŒ é‡å¤ä»»åŠ¡å¯èƒ½è¢«æ™®é€šä»»åŠ¡æ·¹æ²¡
- âŒ ä¹ æƒ¯ç»Ÿè®¡éœ€è¦ç‚¹å‡»å±•å¼€ï¼Œä¸å¤Ÿç›´è§‚
- âŒ é•¿æœŸä»»åŠ¡ä¸é‡å¤ä»»åŠ¡å¯èƒ½æ··æ·†

---

### æ–¹æ¡ˆäºŒï¼šç‹¬ç«‹ä¹ æƒ¯åŒºåŸŸï¼ˆæ¨èåº¦ï¼šâ­â­â­â­â­ï¼‰

#### æ–¹æ¡ˆåç§°
**"ä¹ æƒ¯è¿½è¸ªä¸“åŒº"æ–¹æ¡ˆ**

#### è®¾è®¡æè¿°
åœ¨ä¾§è¾¹æ é¡¶éƒ¨æˆ–åº•éƒ¨åˆ›å»ºç‹¬ç«‹çš„"æ¯æ—¥ä¹ æƒ¯"åŒºåŸŸï¼Œä¸“é—¨å±•ç¤ºæ¯æ—¥é‡å¤ä»»åŠ¡ã€‚è¯¥åŒºåŸŸé‡‡ç”¨å¡ç‰‡å¼å¸ƒå±€ï¼Œæ¯ä¸ªä¹ æƒ¯æ˜¾ç¤ºä¸ºç‹¬ç«‹çš„å¡ç‰‡ï¼ŒåŒ…å«å®ŒæˆçŠ¶æ€ã€è¿ç»­å¤©æ•°ã€è¿›åº¦ç¯ç­‰å…ƒç´ ã€‚æ™®é€šä»»åŠ¡å’Œé•¿æœŸä»»åŠ¡ç»§ç»­åœ¨ä¸‹æ–¹åˆ—è¡¨æ˜¾ç¤ºã€‚

#### æ•°æ®ç»“æ„è®¾è®¡

```javascript
// æ•°æ®ç»“æ„ä¸æ–¹æ¡ˆä¸€ç›¸åŒï¼Œä½†å¢åŠ åˆ†ç»„æ ‡è¯†
{
    // ... åŒæ–¹æ¡ˆä¸€
    
    // æ–°å¢ï¼šä»»åŠ¡åˆ†ç»„
    group: 'habit',  // 'habit' | 'task' | 'longterm'
    
    // ä¹ æƒ¯å¡ç‰‡é…ç½®
    habitCard: {
        icon: 'ğŸƒ',           // ä¹ æƒ¯å›¾æ ‡
        color: '#4caf50',     // å¡ç‰‡ä¸»é¢˜è‰²
        targetDays: null,     // ç›®æ ‡å¤©æ•°ï¼ˆå¯é€‰ï¼‰
        reminderTime: '07:00' // æé†’æ—¶é—´
    }
}
```

#### UI æ¸²æŸ“ä»£ç 

**HTML ç»“æ„**:
```html
<!-- ä¾§è¾¹æ å†…å®¹ -->
<div class="sidebar-content">
    <!-- æ¯æ—¥ä¹ æƒ¯åŒºåŸŸ -->
    <div class="habits-section">
        <div class="section-header">
            <h3 class="section-title">
                <i class="fas fa-fire"></i>
                <span>æ¯æ—¥ä¹ æƒ¯</span>
            </h3>
            <button class="section-toggle" title="æŠ˜å /å±•å¼€">
                <i class="fas fa-chevron-up"></i>
            </button>
        </div>
        
        <div class="habits-grid">
            <!-- ä¹ æƒ¯å¡ç‰‡ -->
            <div class="habit-card" data-id="task_001">
                <div class="habit-card-header">
                    <div class="habit-icon">ğŸƒ</div>
                    <div class="habit-info">
                        <h4 class="habit-title">æ¯æ—¥æ™¨è·‘</h4>
                        <div class="habit-streak">
                            <span class="streak-icon">ğŸ”¥</span>
                            <span class="streak-number">7</span>
                            <span class="streak-text">å¤©è¿ç»­</span>
                        </div>
                    </div>
                </div>
                
                <!-- è¿›åº¦ç¯ -->
                <div class="habit-progress-ring">
                    <svg class="progress-svg" viewBox="0 0 36 36">
                        <circle class="progress-bg" cx="18" cy="18" r="16"></circle>
                        <circle class="progress-bar" cx="18" cy="18" r="16" 
                                stroke-dasharray="75 100"></circle>
                    </svg>
                    <div class="progress-text">75%</div>
                </div>
                
                <!-- å®ŒæˆæŒ‰é’® -->
                <button class="habit-check-btn">
                    <i class="fas fa-check"></i>
                    <span>å®Œæˆ</span>
                </button>
                
                <!-- æœ¬å‘¨å®Œæˆæƒ…å†µ -->
                <div class="habit-week-view">
                    <div class="week-day completed">ä¸€</div>
                    <div class="week-day completed">äºŒ</div>
                    <div class="week-day completed">ä¸‰</div>
                    <div class="week-day completed">å››</div>
                    <div class="week-day completed">äº”</div>
                    <div class="week-day completed">å…­</div>
                    <div class="week-day today">æ—¥</div>
                </div>
            </div>
            
            <!-- æ·»åŠ æ–°ä¹ æƒ¯æŒ‰é’® -->
            <div class="habit-card add-habit-card">
                <button class="add-habit-btn">
                    <i class="fas fa-plus"></i>
                    <span>æ·»åŠ ä¹ æƒ¯</span>
                </button>
            </div>
        </div>
    </div>
    
    <!-- åˆ†éš”çº¿ -->
    <div class="section-divider"></div>
    
    <!-- æ™®é€šä»»åŠ¡åŒºåŸŸ -->
    <div class="tasks-section">
        <!-- ç°æœ‰ä»»åŠ¡åˆ—è¡¨ -->
    </div>
</div>
```

**CSS æ ·å¼**:
```css
/* ä¹ æƒ¯åŒºåŸŸ */
.habits-section {
    padding: 16px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}

.section-title {
    display: flex;
    align-items: center;
    gap: 8px;
    margin: 0;
    font-size: 14px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.9);
}

.section-title i {
    color: #ff6b6b;
}

/* ä¹ æƒ¯ç½‘æ ¼ */
.habits-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 12px;
}

/* ä¹ æƒ¯å¡ç‰‡ */
.habit-card {
    position: relative;
    padding: 16px;
    background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.1) 0%,
        rgba(255, 255, 255, 0.05) 100%
    );
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    backdrop-filter: blur(10px);
    transition: all 0.3s ease;
    cursor: pointer;
}

.habit-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    border-color: rgba(255, 255, 255, 0.2);
}

.habit-card.completed {
    opacity: 0.6;
    background: linear-gradient(
        135deg,
        rgba(76, 175, 80, 0.2) 0%,
        rgba(255, 255, 255, 0.05) 100%
    );
}

.habit-card-header {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    margin-bottom: 12px;
}

.habit-icon {
    font-size: 24px;
    flex-shrink: 0;
}

.habit-info {
    flex: 1;
    min-width: 0;
}

.habit-title {
    margin: 0 0 6px 0;
    font-size: 13px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.95);
    line-height: 1.3;
}

.habit-streak {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 11px;
    color: rgba(255, 107, 107, 0.9);
}

.streak-icon {
    font-size: 12px;
}

.streak-number {
    font-weight: 700;
}

/* è¿›åº¦ç¯ */
.habit-progress-ring {
    position: relative;
    width: 60px;
    height: 60px;
    margin: 12px auto;
}

.progress-svg {
    width: 100%;
    height: 100%;
    transform: rotate(-90deg);
}

.progress-bg {
    fill: none;
    stroke: rgba(255, 255, 255, 0.1);
    stroke-width: 3;
}

.progress-bar {
    fill: none;
    stroke: #4caf50;
    stroke-width: 3;
    stroke-linecap: round;
    stroke-dasharray: 0 100;
    transition: stroke-dasharray 0.5s ease;
}

.progress-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 12px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.9);
}

/* å®ŒæˆæŒ‰é’® */
.habit-check-btn {
    width: 100%;
    padding: 8px;
    margin-top: 8px;
    background: linear-gradient(135deg, #4caf50, #45a049);
    border: none;
    border-radius: 8px;
    color: white;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    transition: all 0.2s;
}

.habit-check-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 2px 8px rgba(76, 175, 80, 0.4);
}

.habit-check-btn:active {
    transform: scale(0.98);
}

.habit-card.completed .habit-check-btn {
    background: rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255, 0.7);
}

/* æœ¬å‘¨è§†å›¾ */
.habit-week-view {
    display: flex;
    gap: 4px;
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.week-day {
    flex: 1;
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.5);
    background: rgba(255, 255, 255, 0.05);
    border-radius: 4px;
    transition: all 0.2s;
}

.week-day.completed {
    background: #4caf50;
    color: white;
}

.week-day.today {
    border: 2px solid #64b5f6;
    color: #64b5f6;
    font-weight: 700;
}

/* æ·»åŠ ä¹ æƒ¯å¡ç‰‡ */
.add-habit-card {
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 180px;
    border-style: dashed;
    background: rgba(255, 255, 255, 0.03);
}

.add-habit-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    padding: 16px;
    background: transparent;
    border: none;
    color: rgba(255, 255, 255, 0.5);
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s;
}

.add-habit-btn:hover {
    color: rgba(255, 255, 255, 0.8);
    transform: scale(1.1);
}

.add-habit-btn i {
    font-size: 24px;
}

/* åˆ†éš”çº¿ */
.section-divider {
    height: 1px;
    margin: 16px 0;
    background: linear-gradient(
        90deg,
        transparent 0%,
        rgba(255, 255, 255, 0.1) 50%,
        transparent 100%
    );
}
```

**JavaScript æ¸²æŸ“é€»è¾‘**:
```javascript
/**
 * æ¸²æŸ“ä¹ æƒ¯åŒºåŸŸ
 */
renderHabitsSection() {
    const habits = this.memos.filter(task => 
        task.recurrence?.enabled && 
        task.recurrence?.type === 'daily' &&
        task.group === 'habit'
    );
    
    const section = document.createElement('div');
    section.className = 'habits-section';
    
    section.innerHTML = `
        <div class="section-header">
            <h3 class="section-title">
                <i class="fas fa-fire"></i>
                <span>æ¯æ—¥ä¹ æƒ¯</span>
            </h3>
            <button class="section-toggle">
                <i class="fas fa-chevron-up"></i>
            </button>
        </div>
        <div class="habits-grid" id="habits-grid"></div>
    `;
    
    const grid = section.querySelector('#habits-grid');
    
    // æ¸²æŸ“ä¹ æƒ¯å¡ç‰‡
    habits.forEach(habit => {
        const card = this.createHabitCard(habit);
        grid.appendChild(card);
    });
    
    // æ·»åŠ "æ·»åŠ ä¹ æƒ¯"æŒ‰é’®
    const addCard = this.createAddHabitCard();
    grid.appendChild(addCard);
    
    return section;
}

/**
 * åˆ›å»ºä¹ æƒ¯å¡ç‰‡
 */
createHabitCard(habit) {
    const card = document.createElement('div');
    card.className = `habit-card ${habit.completed ? 'completed' : ''}`;
    card.dataset.id = habit.id;
    
    // è®¡ç®—æœ¬å‘¨å®Œæˆæƒ…å†µ
    const weekData = this.getWeekCompletion(habit);
    const completionRate = Math.round((weekData.completed / 7) * 100);
    
    // è®¡ç®—è¿›åº¦ç¯çš„ stroke-dasharray
    const circumference = 2 * Math.PI * 16; // r=16
    const completedLength = (completionRate / 100) * circumference;
    
    card.innerHTML = `
        <div class="habit-card-header">
            <div class="habit-icon">${habit.habitCard?.icon || 'ğŸ“'}</div>
            <div class="habit-info">
                <h4 class="habit-title">${habit.title}</h4>
                <div class="habit-streak">
                    <span class="streak-icon">ğŸ”¥</span>
                    <span class="streak-number">${habit.habit?.streak || 0}</span>
                    <span class="streak-text">å¤©è¿ç»­</span>
                </div>
            </div>
        </div>
        
        <div class="habit-progress-ring">
            <svg class="progress-svg" viewBox="0 0 36 36">
                <circle class="progress-bg" cx="18" cy="18" r="16"></circle>
                <circle class="progress-bar" cx="18" cy="18" r="16" 
                        stroke-dasharray="${completedLength} ${circumference}"></circle>
            </svg>
            <div class="progress-text">${completionRate}%</div>
        </div>
        
        <button class="habit-check-btn">
            <i class="fas fa-check"></i>
            <span>${habit.completed ? 'å·²å®Œæˆ' : 'å®Œæˆ'}</span>
        </button>
        
        <div class="habit-week-view">
            ${this.renderWeekDays(weekData)}
        </div>
    `;
    
    // ç»‘å®šå®ŒæˆæŒ‰é’®äº‹ä»¶
    const checkBtn = card.querySelector('.habit-check-btn');
    checkBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        this.toggleHabitCompletion(habit.id);
    });
    
    // ç‚¹å‡»å¡ç‰‡æŸ¥çœ‹è¯¦æƒ…
    card.addEventListener('click', () => {
        this.showHabitDetail(habit);
    });
    
    return card;
}

/**
 * è·å–æœ¬å‘¨å®Œæˆæƒ…å†µ
 */
getWeekCompletion(habit) {
    const today = new Date();
    const weekStart = new Date(today);
    weekStart.setDate(today.getDate() - today.getDay() + 1); // å‘¨ä¸€
    
    const weekData = {
        completed: 0,
        days: []
    };
    
    for (let i = 0; i < 7; i++) {
        const date = new Date(weekStart);
        date.setDate(weekStart.getDate() + i);
        const dateStr = this.getDateString(date);
        
        const isCompleted = habit.habit?.completedDates?.includes(dateStr) || false;
        const isToday = dateStr === this.getTodayDate();
        
        weekData.days.push({
            date: dateStr,
            completed: isCompleted,
            isToday: isToday,
            label: ['ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­', 'æ—¥'][i]
        });
        
        if (isCompleted) weekData.completed++;
    }
    
    return weekData;
}

/**
 * æ¸²æŸ“å‘¨è§†å›¾
 */
renderWeekDays(weekData) {
    return weekData.days.map(day => {
        const classes = ['week-day'];
        if (day.completed) classes.push('completed');
        if (day.isToday) classes.push('today');
        
        return `<div class="${classes.join(' ')}">${day.label}</div>`;
    }).join('');
}

/**
 * åˆ‡æ¢ä¹ æƒ¯å®ŒæˆçŠ¶æ€
 */
async toggleHabitCompletion(habitId) {
    const habit = this.memos.find(t => t.id === habitId);
    if (!habit) return;
    
    const today = this.getTodayDate();
    const isCompleted = habit.habit?.completedDates?.includes(today);
    
    if (isCompleted) {
        // å–æ¶ˆå®Œæˆ
        habit.completed = false;
        habit.habit.completedDates = habit.habit.completedDates.filter(d => d !== today);
        habit.habit.streak = this.calculateStreak(habit.habit.completedDates);
    } else {
        // æ ‡è®°å®Œæˆ
        habit.completed = true;
        if (!habit.habit) {
            habit.habit = {
                streak: 0,
                bestStreak: 0,
                completedDates: [],
                totalCompletions: 0
            };
        }
        
        if (!habit.habit.completedDates.includes(today)) {
            habit.habit.completedDates.push(today);
            habit.habit.totalCompletions++;
        }
        
        habit.habit.streak = this.calculateStreak(habit.habit.completedDates);
        if (habit.habit.streak > habit.habit.bestStreak) {
            habit.habit.bestStreak = habit.habit.streak;
        }
    }
    
    await this.saveTask(habit);
    this.renderSidebarContent();
}

/**
 * è®¡ç®—è¿ç»­å¤©æ•°
 */
calculateStreak(completedDates) {
    if (!completedDates || completedDates.length === 0) return 0;
    
    const sorted = [...completedDates].sort().reverse();
    let streak = 0;
    let expectedDate = this.getTodayDate();
    
    for (const date of sorted) {
        if (date === expectedDate) {
            streak++;
            const dateObj = new Date(date);
            dateObj.setDate(dateObj.getDate() - 1);
            expectedDate = this.getDateString(dateObj);
        } else {
            break;
        }
    }
    
    return streak;
}
```

#### ä¼˜ç¼ºç‚¹åˆ†æ

**ä¼˜ç‚¹**:
- âœ… ä¹ æƒ¯ä»»åŠ¡ä¸æ™®é€šä»»åŠ¡åˆ†ç¦»ï¼Œè§†è§‰å±‚æ¬¡æ¸…æ™°
- âœ… å¡ç‰‡å¼è®¾è®¡ç¾è§‚ï¼Œç¬¦åˆç°ä»£UIè¶‹åŠ¿
- âœ… è¿›åº¦ç¯å’Œå‘¨è§†å›¾æä¾›ç›´è§‚çš„å®Œæˆåé¦ˆ
- âœ… è¿ç»­å¤©æ•°å¾½ç« å¢å¼ºæˆå°±æ„Ÿ
- âœ… ç‹¬ç«‹åŒºåŸŸä¾¿äºå¿«é€ŸæŸ¥çœ‹å’Œæ“ä½œ

**ç¼ºç‚¹**:
- âŒ éœ€è¦é¢å¤–çš„UIç©ºé—´
- âŒ å®ç°å¤æ‚åº¦è¾ƒé«˜
- âŒ å¯èƒ½ä¸å…¶ä»–ä»»åŠ¡äº§ç”Ÿå‰²è£‚æ„Ÿ

---

### æ–¹æ¡ˆä¸‰ï¼šæ—¥å†çƒ­åŠ›å›¾ï¼ˆæ¨èåº¦ï¼šâ­â­â­ï¼‰

#### æ–¹æ¡ˆåç§°
**"æ—¥å†çƒ­åŠ›å›¾ + åˆ—è¡¨æ··åˆ"æ–¹æ¡ˆ**

#### è®¾è®¡æè¿°
åœ¨ä¾§è¾¹æ é¡¶éƒ¨æ˜¾ç¤ºä¸€ä¸ªç´§å‡‘çš„æ—¥å†çƒ­åŠ›å›¾ï¼Œå±•ç¤ºæ‰€æœ‰æ¯æ—¥ä¹ æƒ¯çš„å®Œæˆå†å²ã€‚æ¯ä¸ªä¹ æƒ¯ä¸€è¡Œï¼Œæ˜¾ç¤ºæœ€è¿‘30å¤©çš„å®Œæˆæƒ…å†µã€‚ç‚¹å‡»çƒ­åŠ›å›¾å¯ä»¥æŸ¥çœ‹è¯¦ç»†ç»Ÿè®¡ã€‚ä¸‹æ–¹ç»§ç»­æ˜¾ç¤ºä»»åŠ¡åˆ—è¡¨ã€‚

#### æ•°æ®ç»“æ„è®¾è®¡

```javascript
// æ•°æ®ç»“æ„ä¸æ–¹æ¡ˆä¸€ç›¸åŒï¼Œå¢åŠ çƒ­åŠ›å›¾æ‰€éœ€æ•°æ®
{
    // ... åŒæ–¹æ¡ˆä¸€
    
    // çƒ­åŠ›å›¾æ•°æ®ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
    heatmapData: {
        last30Days: [
            { date: '2026-01-08', completed: true },
            { date: '2026-01-09', completed: true },
            { date: '2026-01-10', completed: false },
            // ... 30å¤©æ•°æ®
        ],
        completionRate: 0.75  // å®Œæˆç‡
    }
}
```

#### UI æ¸²æŸ“ä»£ç 

**HTML ç»“æ„**:
```html
<!-- ä¹ æƒ¯çƒ­åŠ›å›¾åŒºåŸŸ -->
<div class="habits-heatmap-section">
    <div class="section-header">
        <h3 class="section-title">
            <i class="fas fa-calendar-alt"></i>
            <span>ä¹ æƒ¯è¿½è¸ª</span>
        </h3>
        <button class="heatmap-toggle" title="å±•å¼€/æ”¶èµ·">
            <i class="fas fa-chevron-down"></i>
        </button>
    </div>
    
    <div class="habits-heatmap-container">
        <!-- ä¹ æƒ¯çƒ­åŠ›å›¾é¡¹ -->
        <div class="heatmap-item" data-id="task_001">
            <div class="heatmap-header">
                <span class="heatmap-title">æ¯æ—¥æ™¨è·‘</span>
                <span class="heatmap-streak">ğŸ”¥ 7</span>
            </div>
            
            <div class="heatmap-grid">
                <!-- 30å¤©çƒ­åŠ›å›¾ -->
                <div class="heatmap-day" 
                     data-date="2026-01-08" 
                     data-completed="true"
                     title="2026-01-08 å·²å®Œæˆ"></div>
                <div class="heatmap-day" 
                     data-date="2026-01-09" 
                     data-completed="true"
                     title="2026-01-09 å·²å®Œæˆ"></div>
                <!-- ... æ›´å¤šæ—¥æœŸ -->
            </div>
            
            <div class="heatmap-stats">
                <span class="stat">å®Œæˆç‡: 75%</span>
                <span class="stat">è¿ç»­: 7å¤©</span>
            </div>
        </div>
    </div>
</div>
```

**CSS æ ·å¼**:
```css
/* çƒ­åŠ›å›¾åŒºåŸŸ */
.habits-heatmap-section {
    padding: 16px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    background: rgba(0, 0, 0, 0.2);
}

.habits-heatmap-container {
    margin-top: 12px;
}

/* çƒ­åŠ›å›¾é¡¹ */
.heatmap-item {
    margin-bottom: 16px;
    padding: 12px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
}

.heatmap-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.heatmap-title {
    font-size: 13px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.9);
}

.heatmap-streak {
    font-size: 11px;
    color: #ff6b6b;
    font-weight: 600;
}

/* çƒ­åŠ›å›¾ç½‘æ ¼ */
.heatmap-grid {
    display: grid;
    grid-template-columns: repeat(30, 1fr);
    gap: 3px;
    margin-bottom: 8px;
}

.heatmap-day {
    aspect-ratio: 1;
    border-radius: 3px;
    background: rgba(255, 255, 255, 0.1);
    transition: all 0.2s;
    cursor: pointer;
}

.heatmap-day:hover {
    transform: scale(1.2);
    z-index: 1;
}

.heatmap-day[data-completed="true"] {
    background: #4caf50;
}

.heatmap-day[data-completed="false"] {
    background: rgba(255, 255, 255, 0.1);
}

/* å¼ºåº¦åˆ†çº§ï¼ˆå¯é€‰ï¼‰ */
.heatmap-day.intensity-1 { background: rgba(76, 175, 80, 0.3); }
.heatmap-day.intensity-2 { background: rgba(76, 175, 80, 0.6); }
.heatmap-day.intensity-3 { background: rgba(76, 175, 80, 0.9); }
.heatmap-day.intensity-4 { background: #4caf50; }

/* ç»Ÿè®¡ä¿¡æ¯ */
.heatmap-stats {
    display: flex;
    gap: 12px;
    font-size: 11px;
    color: rgba(255, 255, 255, 0.6);
}

.heatmap-stats .stat {
    display: flex;
    align-items: center;
}
```

**JavaScript æ¸²æŸ“é€»è¾‘**:
```javascript
/**
 * æ¸²æŸ“ä¹ æƒ¯çƒ­åŠ›å›¾
 */
renderHabitsHeatmap() {
    const habits = this.memos.filter(task => 
        task.recurrence?.enabled && 
        task.recurrence?.type === 'daily'
    );
    
    const section = document.createElement('div');
    section.className = 'habits-heatmap-section';
    
    section.innerHTML = `
        <div class="section-header">
            <h3 class="section-title">
                <i class="fas fa-calendar-alt"></i>
                <span>ä¹ æƒ¯è¿½è¸ª</span>
            </h3>
            <button class="heatmap-toggle">
                <i class="fas fa-chevron-down"></i>
            </button>
        </div>
        <div class="habits-heatmap-container" id="habits-heatmap-container"></div>
    `;
    
    const container = section.querySelector('#habits-heatmap-container');
    
    habits.forEach(habit => {
        const heatmapItem = this.createHeatmapItem(habit);
        container.appendChild(heatmapItem);
    });
    
    return section;
}

/**
 * åˆ›å»ºçƒ­åŠ›å›¾é¡¹
 */
createHeatmapItem(habit) {
    const item = document.createElement('div');
    item.className = 'heatmap-item';
    item.dataset.id = habit.id;
    
    // ç”Ÿæˆæœ€è¿‘30å¤©çš„æ•°æ®
    const last30Days = this.generateLast30Days(habit);
    const completionRate = Math.round(
        (last30Days.filter(d => d.completed).length / 30) * 100
    );
    
    const heatmapGrid = last30Days.map(day => {
        const intensity = this.calculateIntensity(day, habit);
        return `
            <div class="heatmap-day ${day.completed ? 'intensity-' + intensity : ''}" 
                 data-date="${day.date}" 
                 data-completed="${day.completed}"
                 title="${day.date} ${day.completed ? 'å·²å®Œæˆ' : 'æœªå®Œæˆ'}"></div>
        `;
    }).join('');
    
    item.innerHTML = `
        <div class="heatmap-header">
            <span class="heatmap-title">${habit.title}</span>
            <span class="heatmap-streak">ğŸ”¥ ${habit.habit?.streak || 0}</span>
        </div>
        <div class="heatmap-grid">
            ${heatmapGrid}
        </div>
        <div class="heatmap-stats">
            <span class="stat">å®Œæˆç‡: ${completionRate}%</span>
            <span class="stat">è¿ç»­: ${habit.habit?.streak || 0}å¤©</span>
        </div>
    `;
    
    // ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…
    item.addEventListener('click', () => {
        this.showHabitDetail(habit);
    });
    
    return item;
}

/**
 * ç”Ÿæˆæœ€è¿‘30å¤©çš„æ•°æ®
 */
generateLast30Days(habit) {
    const days = [];
    const today = new Date();
    
    for (let i = 29; i >= 0; i--) {
        const date = new Date(today);
        date.setDate(today.getDate() - i);
        const dateStr = this.getDateString(date);
        
        days.push({
            date: dateStr,
            completed: habit.habit?.completedDates?.includes(dateStr) || false
        });
    }
    
    return days;
}

/**
 * è®¡ç®—å¼ºåº¦ï¼ˆç”¨äºé¢œè‰²åˆ†çº§ï¼‰
 */
calculateIntensity(day, habit) {
    if (!day.completed) return 0;
    
    // å¯ä»¥æ ¹æ®å®Œæˆè´¨é‡ã€æ—¶é•¿ç­‰è®¡ç®—å¼ºåº¦
    // è¿™é‡Œç®€å•è¿”å›å›ºå®šå€¼
    return 4;
}
```

#### ä¼˜ç¼ºç‚¹åˆ†æ

**ä¼˜ç‚¹**:
- âœ… å†å²æ•°æ®ä¸€ç›®äº†ç„¶ï¼Œè§†è§‰å†²å‡»åŠ›å¼º
- âœ… ç±»ä¼¼ GitHub Contributions çš„ç†Ÿæ‚‰æ„Ÿ
- âœ… é€‚åˆé•¿æœŸä¹ æƒ¯è¿½è¸ª
- âœ… å ç”¨ç©ºé—´ç›¸å¯¹ç´§å‡‘

**ç¼ºç‚¹**:
- âŒ å®ç°å¤æ‚åº¦è¾ƒé«˜
- âŒ åœ¨å°å±å¹•ä¸Šå¯èƒ½æ˜¾ç¤ºä¸ä½³
- âŒ éœ€è¦è®¡ç®—å’Œå­˜å‚¨å¤§é‡å†å²æ•°æ®
- âŒ å¯¹çŸ­æœŸç”¨æˆ·ä»·å€¼æœ‰é™

---

### æ–¹æ¡ˆå››ï¼šæŠ˜å å¼ä¹ æƒ¯åˆ—è¡¨ï¼ˆæ¨èåº¦ï¼šâ­â­â­â­ï¼‰

#### æ–¹æ¡ˆåç§°
**"å¯æŠ˜å ä¹ æƒ¯ç»„"æ–¹æ¡ˆ**

#### è®¾è®¡æè¿°
åœ¨ä»»åŠ¡åˆ—è¡¨é¡¶éƒ¨æ·»åŠ ä¸€ä¸ªå¯æŠ˜å çš„"æ¯æ—¥ä¹ æƒ¯"åˆ†ç»„ã€‚è¯¥åˆ†ç»„é»˜è®¤å±•å¼€ï¼Œæ˜¾ç¤ºæ‰€æœ‰æ¯æ—¥é‡å¤ä»»åŠ¡ã€‚æ¯ä¸ªä¹ æƒ¯æ˜¾ç¤ºä¸ºç²¾ç®€çš„ä»»åŠ¡é¡¹ï¼ŒåŒ…å«æ ‡é¢˜ã€è¿ç»­å¤©æ•°ã€ä»Šæ—¥å®ŒæˆçŠ¶æ€ã€‚ç‚¹å‡»åˆ†ç»„æ ‡é¢˜å¯ä»¥æŠ˜å /å±•å¼€ã€‚é•¿æœŸä»»åŠ¡å¯ä»¥æ”¾åœ¨å¦ä¸€ä¸ªåˆ†ç»„ä¸­ã€‚

#### æ•°æ®ç»“æ„è®¾è®¡

```javascript
// æ•°æ®ç»“æ„ä¸æ–¹æ¡ˆä¸€ç›¸åŒï¼Œå¢åŠ åˆ†ç»„ä¿¡æ¯
{
    // ... åŒæ–¹æ¡ˆä¸€
    
    // ä»»åŠ¡åˆ†ç»„ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼‰
    displayGroup: 'habits',  // 'habits' | 'tasks' | 'longterm'
}
```

#### UI æ¸²æŸ“ä»£ç 

**HTML ç»“æ„**:
```html
<!-- ä¾§è¾¹æ å†…å®¹ -->
<div class="sidebar-content">
    <!-- æ¯æ—¥ä¹ æƒ¯åˆ†ç»„ -->
    <div class="task-group habits-group" data-group="habits">
        <div class="group-header" data-toggle="habits">
            <div class="group-title">
                <i class="fas fa-fire group-icon"></i>
                <span>æ¯æ—¥ä¹ æƒ¯</span>
                <span class="group-count">(3)</span>
            </div>
            <div class="group-actions">
                <span class="group-stats">ğŸ”¥ æœ€é•¿7å¤©</span>
                <i class="fas fa-chevron-down group-toggle"></i>
            </div>
        </div>
        
        <div class="group-content" id="habits-content">
            <!-- ä¹ æƒ¯ä»»åŠ¡é¡¹ -->
            <div class="sidebar-task-item recurring-task daily-task" data-id="task_001">
                <div class="task-checkbox">
                    <i class="far fa-circle"></i>
                </div>
                <div class="task-body">
                    <div class="task-header">
                        <span class="task-title">æ¯æ—¥æ™¨è·‘</span>
                        <div class="task-habit-indicator">
                            <span class="habit-streak-badge">ğŸ”¥ 7</span>
                        </div>
                    </div>
                </div>
            </div>
            <!-- æ›´å¤šä¹ æƒ¯... -->
        </div>
    </div>
    
    <!-- æ™®é€šä»»åŠ¡åˆ†ç»„ -->
    <div class="task-group tasks-group" data-group="tasks">
        <div class="group-header" data-toggle="tasks">
            <div class="group-title">
                <i class="fas fa-tasks group-icon"></i>
                <span>ä»»åŠ¡</span>
                <span class="group-count">(5)</span>
            </div>
            <i class="fas fa-chevron-down group-toggle"></i>
        </div>
        <div class="group-content" id="tasks-content">
            <!-- æ™®é€šä»»åŠ¡é¡¹ -->
        </div>
    </div>
</div>
```

**CSS æ ·å¼**:
```css
/* ä»»åŠ¡åˆ†ç»„ */
.task-group {
    margin-bottom: 8px;
}

.group-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    cursor: pointer;
    user-select: none;
    transition: all 0.2s;
}

.group-header:hover {
    background: rgba(255, 255, 255, 0.08);
}

.group-title {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 13px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.9);
}

.group-icon {
    color: #ff6b6b;
    font-size: 12px;
}

.group-count {
    color: rgba(255, 255, 255, 0.5);
    font-weight: 400;
}

.group-actions {
    display: flex;
    align-items: center;
    gap: 12px;
}

.group-stats {
    font-size: 11px;
    color: rgba(255, 107, 107, 0.8);
}

.group-toggle {
    font-size: 10px;
    color: rgba(255, 255, 255, 0.5);
    transition: transform 0.2s;
}

.task-group.collapsed .group-toggle {
    transform: rotate(-90deg);
}

/* åˆ†ç»„å†…å®¹ */
.group-content {
    padding: 8px 0;
    max-height: 1000px;
    overflow: hidden;
    transition: max-height 0.3s ease, opacity 0.3s ease;
}

.task-group.collapsed .group-content {
    max-height: 0;
    opacity: 0;
    padding: 0;
}

/* ä¹ æƒ¯åˆ†ç»„ç‰¹æ®Šæ ·å¼ */
.habits-group .group-header {
    background: linear-gradient(
        135deg,
        rgba(255, 107, 107, 0.15) 0%,
        rgba(255, 255, 255, 0.05) 100%
    );
    border-left: 3px solid #ff6b6b;
}

.habits-group .group-content .sidebar-task-item {
    margin-left: 12px;
    border-left: 2px solid rgba(255, 107, 107, 0.3);
}

/* ä¹ æƒ¯æŒ‡ç¤ºå™¨ */
.task-habit-indicator {
    display: flex;
    align-items: center;
    gap: 6px;
}

.habit-streak-badge {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 2px 8px;
    background: rgba(255, 107, 107, 0.2);
    border-radius: 10px;
    font-size: 11px;
    font-weight: 600;
    color: #ff6b6b;
}

/* é•¿æœŸä»»åŠ¡åˆ†ç»„ */
.longterm-group .group-header {
    background: linear-gradient(
        135deg,
        rgba(156, 39, 176, 0.15) 0%,
        rgba(255, 255, 255, 0.05) 100%
    );
    border-left: 3px solid #9c27b0;
}

.longterm-group .group-icon {
    color: #9c27b0;
}
```

**JavaScript æ¸²æŸ“é€»è¾‘**:
```javascript
/**
 * æ¸²æŸ“åˆ†ç»„ä»»åŠ¡åˆ—è¡¨
 */
renderGroupedTasks() {
    const container = document.getElementById('sidebar-content');
    container.innerHTML = '';
    
    // åˆ†ç»„ä»»åŠ¡
    const habits = this.memos.filter(t => 
        t.recurrence?.enabled && t.recurrence?.type === 'daily'
    );
    const longTerm = this.memos.filter(t => 
        t.longTerm?.enabled
    );
    const regularTasks = this.memos.filter(t => 
        !t.recurrence?.enabled && !t.longTerm?.enabled
    );
    
    // æ¸²æŸ“ä¹ æƒ¯åˆ†ç»„
    if (habits.length > 0) {
        const habitsGroup = this.createTaskGroup('habits', 'æ¯æ—¥ä¹ æƒ¯', habits, {
            icon: 'fa-fire',
            stats: `ğŸ”¥ æœ€é•¿${Math.max(...habits.map(h => h.habit?.streak || 0))}å¤©`
        });
        container.appendChild(habitsGroup);
    }
    
    // æ¸²æŸ“é•¿æœŸä»»åŠ¡åˆ†ç»„
    if (longTerm.length > 0) {
        const longTermGroup = this.createTaskGroup('longterm', 'é•¿æœŸä»»åŠ¡', longTerm, {
            icon: 'fa-calendar-alt'
        });
        container.appendChild(longTermGroup);
    }
    
    // æ¸²æŸ“æ™®é€šä»»åŠ¡åˆ†ç»„
    if (regularTasks.length > 0) {
        const tasksGroup = this.createTaskGroup('tasks', 'ä»»åŠ¡', regularTasks, {
            icon: 'fa-tasks'
        });
        container.appendChild(tasksGroup);
    }
}

/**
 * åˆ›å»ºä»»åŠ¡åˆ†ç»„
 */
createTaskGroup(groupId, title, tasks, options = {}) {
    const group = document.createElement('div');
    group.className = `task-group ${groupId}-group`;
    group.dataset.group = groupId;
    
    const header = document.createElement('div');
    header.className = 'group-header';
    header.dataset.toggle = groupId;
    
    header.innerHTML = `
        <div class="group-title">
            <i class="fas ${options.icon || 'fa-tasks'} group-icon"></i>
            <span>${title}</span>
            <span class="group-count">(${tasks.length})</span>
        </div>
        <div class="group-actions">
            ${options.stats ? `<span class="group-stats">${options.stats}</span>` : ''}
            <i class="fas fa-chevron-down group-toggle"></i>
        </div>
    `;
    
    const content = document.createElement('div');
    content.className = 'group-content';
    content.id = `${groupId}-content`;
    
    // æ¸²æŸ“ä»»åŠ¡é¡¹
    tasks.forEach((task, index) => {
        const taskItem = this.createSidebarTaskItem(task, index + 1, tasks.length);
        content.appendChild(taskItem);
    });
    
    group.appendChild(header);
    group.appendChild(content);
    
    // ç»‘å®šæŠ˜å /å±•å¼€äº‹ä»¶
    header.addEventListener('click', () => {
        group.classList.toggle('collapsed');
    });
    
    return group;
}
```

#### ä¼˜ç¼ºç‚¹åˆ†æ

**ä¼˜ç‚¹**:
- âœ… ä¸ç°æœ‰ç³»ç»Ÿå®Œç¾èåˆ
- âœ… èŠ‚çœç©ºé—´ï¼Œå¯æŒ‰éœ€å±•å¼€/æŠ˜å 
- âœ… å®ç°ç®€å•ï¼Œæ”¹åŠ¨æœ€å°
- âœ… åˆ†ç»„æ¸…æ™°ï¼Œæ˜“äºç®¡ç†
- âœ… æ”¯æŒå¤šä¸ªåˆ†ç»„ï¼ˆä¹ æƒ¯ã€é•¿æœŸã€æ™®é€šï¼‰

**ç¼ºç‚¹**:
- âŒ è§†è§‰å†²å‡»åŠ›ä¸å¦‚å¡ç‰‡å¼
- âŒ ä¹ æƒ¯ç»Ÿè®¡ä¿¡æ¯å±•ç¤ºæœ‰é™
- âŒ éœ€è¦ç‚¹å‡»å±•å¼€æ‰èƒ½çœ‹åˆ°æ‰€æœ‰ä¹ æƒ¯

---

### æ–¹æ¡ˆäº”ï¼šæ··åˆå±•ç¤ºï¼ˆæ¨èåº¦ï¼šâ­â­â­â­â­ï¼‰

#### æ–¹æ¡ˆåç§°
**"å¡ç‰‡ + åˆ—è¡¨æ··åˆ"æ–¹æ¡ˆ**

#### è®¾è®¡æè¿°
ç»“åˆæ–¹æ¡ˆäºŒå’Œæ–¹æ¡ˆå››çš„ä¼˜ç‚¹ï¼šåœ¨ä¾§è¾¹æ é¡¶éƒ¨æ˜¾ç¤ºä¸€ä¸ªç´§å‡‘çš„ä¹ æƒ¯å¡ç‰‡åŒºåŸŸï¼ˆæ˜¾ç¤º2-3ä¸ªæœ€é‡è¦çš„ä¹ æƒ¯ï¼‰ï¼Œä¸‹æ–¹æ˜¯å¯æŠ˜å çš„ä¹ æƒ¯åˆ—è¡¨ï¼ˆæ˜¾ç¤ºæ‰€æœ‰ä¹ æƒ¯ï¼‰ï¼Œå†ä¸‹æ–¹æ˜¯æ™®é€šä»»åŠ¡åˆ—è¡¨ã€‚è¿™æ ·æ—¢ä¿è¯äº†é‡è¦ä¹ æƒ¯çš„çªå‡ºæ˜¾ç¤ºï¼Œåˆä¸ä¼šå ç”¨è¿‡å¤šç©ºé—´ã€‚

#### æ•°æ®ç»“æ„è®¾è®¡

```javascript
// æ•°æ®ç»“æ„ä¸æ–¹æ¡ˆä¸€ç›¸åŒï¼Œå¢åŠ ä¼˜å…ˆçº§æ ‡è¯†
{
    // ... åŒæ–¹æ¡ˆä¸€
    
    // ä¹ æƒ¯æ˜¾ç¤ºä¼˜å…ˆçº§ï¼ˆç”¨äºå†³å®šæ˜¯å¦åœ¨é¡¶éƒ¨å¡ç‰‡æ˜¾ç¤ºï¼‰
    habitPriority: 'high',  // 'high' | 'normal'
}
```

#### UI æ¸²æŸ“ä»£ç 

**HTML ç»“æ„**:
```html
<!-- ä¾§è¾¹æ å†…å®¹ -->
<div class="sidebar-content">
    <!-- é¡¶éƒ¨é‡è¦ä¹ æƒ¯å¡ç‰‡ï¼ˆæœ€å¤š3ä¸ªï¼‰ -->
    <div class="top-habits-section">
        <div class="section-header">
            <h3 class="section-title">
                <i class="fas fa-star"></i>
                <span>é‡ç‚¹ä¹ æƒ¯</span>
            </h3>
        </div>
        <div class="top-habits-grid">
            <!-- é‡è¦ä¹ æƒ¯å¡ç‰‡ï¼ˆç®€åŒ–ç‰ˆï¼‰ -->
            <div class="top-habit-card" data-id="task_001">
                <div class="top-habit-icon">ğŸƒ</div>
                <div class="top-habit-info">
                    <div class="top-habit-title">æ¯æ—¥æ™¨è·‘</div>
                    <div class="top-habit-streak">ğŸ”¥ 7</div>
                </div>
                <button class="top-habit-check">
                    <i class="fas fa-check"></i>
                </button>
            </div>
        </div>
    </div>
    
    <!-- æ‰€æœ‰ä¹ æƒ¯åˆ†ç»„ï¼ˆå¯æŠ˜å ï¼‰ -->
    <div class="task-group habits-group collapsed" data-group="habits">
        <!-- åŒæ–¹æ¡ˆå›› -->
    </div>
    
    <!-- æ™®é€šä»»åŠ¡åˆ†ç»„ -->
    <div class="task-group tasks-group" data-group="tasks">
        <!-- åŒæ–¹æ¡ˆå›› -->
    </div>
</div>
```

**CSS æ ·å¼**:
```css
/* é¡¶éƒ¨é‡è¦ä¹ æƒ¯åŒºåŸŸ */
.top-habits-section {
    padding: 12px 16px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    background: linear-gradient(
        180deg,
        rgba(255, 107, 107, 0.1) 0%,
        transparent 100%
    );
}

.top-habits-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 8px;
    margin-top: 8px;
}

/* é¡¶éƒ¨ä¹ æƒ¯å¡ç‰‡ï¼ˆç´§å‡‘ç‰ˆï¼‰ */
.top-habit-card {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px;
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    transition: all 0.2s;
    cursor: pointer;
}

.top-habit-card:hover {
    background: rgba(255, 255, 255, 0.12);
    transform: translateY(-1px);
}

.top-habit-card.completed {
    opacity: 0.6;
    border-color: rgba(76, 175, 80, 0.5);
}

.top-habit-icon {
    font-size: 20px;
    flex-shrink: 0;
}

.top-habit-info {
    flex: 1;
    min-width: 0;
}

.top-habit-title {
    font-size: 12px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.9);
    margin-bottom: 2px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.top-habit-streak {
    font-size: 10px;
    color: #ff6b6b;
    font-weight: 600;
}

.top-habit-check {
    flex-shrink: 0;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(76, 175, 80, 0.2);
    border: 1px solid rgba(76, 175, 80, 0.4);
    border-radius: 6px;
    color: #4caf50;
    cursor: pointer;
    transition: all 0.2s;
}

.top-habit-check:hover {
    background: rgba(76, 175, 80, 0.3);
    transform: scale(1.1);
}

.top-habit-card.completed .top-habit-check {
    background: #4caf50;
    color: white;
}
```

**JavaScript æ¸²æŸ“é€»è¾‘**:
```javascript
/**
 * æ¸²æŸ“æ··åˆå¸ƒå±€
 */
renderHybridLayout() {
    const container = document.getElementById('sidebar-content');
    container.innerHTML = '';
    
    const habits = this.memos.filter(t => 
        t.recurrence?.enabled && t.recurrence?.type === 'daily'
    );
    
    // è·å–é‡è¦ä¹ æƒ¯ï¼ˆä¼˜å…ˆçº§é«˜çš„ï¼Œæœ€å¤š3ä¸ªï¼‰
    const topHabits = habits
        .filter(h => h.habitPriority === 'high')
        .slice(0, 3);
    
    // æ¸²æŸ“é¡¶éƒ¨é‡è¦ä¹ æƒ¯
    if (topHabits.length > 0) {
        const topSection = this.createTopHabitsSection(topHabits);
        container.appendChild(topSection);
    }
    
    // æ¸²æŸ“æ‰€æœ‰ä¹ æƒ¯åˆ†ç»„ï¼ˆé»˜è®¤æŠ˜å ï¼‰
    if (habits.length > 0) {
        const habitsGroup = this.createTaskGroup('habits', 'æ‰€æœ‰ä¹ æƒ¯', habits, {
            icon: 'fa-fire',
            collapsed: true  // é»˜è®¤æŠ˜å 
        });
        container.appendChild(habitsGroup);
    }
    
    // æ¸²æŸ“æ™®é€šä»»åŠ¡
    const regularTasks = this.memos.filter(t => 
        !t.recurrence?.enabled && !t.longTerm?.enabled
    );
    if (regularTasks.length > 0) {
        const tasksGroup = this.createTaskGroup('tasks', 'ä»»åŠ¡', regularTasks);
        container.appendChild(tasksGroup);
    }
}

/**
 * åˆ›å»ºé¡¶éƒ¨é‡è¦ä¹ æƒ¯åŒºåŸŸ
 */
createTopHabitsSection(habits) {
    const section = document.createElement('div');
    section.className = 'top-habits-section';
    
    section.innerHTML = `
        <div class="section-header">
            <h3 class="section-title">
                <i class="fas fa-star"></i>
                <span>é‡ç‚¹ä¹ æƒ¯</span>
            </h3>
        </div>
        <div class="top-habits-grid" id="top-habits-grid"></div>
    `;
    
    const grid = section.querySelector('#top-habits-grid');
    
    habits.forEach(habit => {
        const card = this.createTopHabitCard(habit);
        grid.appendChild(card);
    });
    
    return section;
}

/**
 * åˆ›å»ºé¡¶éƒ¨ä¹ æƒ¯å¡ç‰‡
 */
createTopHabitCard(habit) {
    const card = document.createElement('div');
    card.className = `top-habit-card ${habit.completed ? 'completed' : ''}`;
    card.dataset.id = habit.id;
    
    const today = this.getTodayDate();
    const isCompleted = habit.habit?.completedDates?.includes(today);
    
    card.innerHTML = `
        <div class="top-habit-icon">${habit.habitCard?.icon || 'ğŸ“'}</div>
        <div class="top-habit-info">
            <div class="top-habit-title">${habit.title}</div>
            <div class="top-habit-streak">ğŸ”¥ ${habit.habit?.streak || 0}</div>
        </div>
        <button class="top-habit-check">
            <i class="fas fa-check"></i>
        </button>
    `;
    
    const checkBtn = card.querySelector('.top-habit-check');
    checkBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        this.toggleHabitCompletion(habit.id);
    });
    
    card.addEventListener('click', () => {
        this.showTaskDetail(habit.id);
    });
    
    return card;
}
```

#### ä¼˜ç¼ºç‚¹åˆ†æ

**ä¼˜ç‚¹**:
- âœ… å…¼é¡¾é‡è¦ä¹ æƒ¯çš„çªå‡ºæ˜¾ç¤ºå’Œç©ºé—´æ•ˆç‡
- âœ… é¡¶éƒ¨å¡ç‰‡æä¾›å¿«é€Ÿæ“ä½œå…¥å£
- âœ… ä¸‹æ–¹åˆ—è¡¨æä¾›å®Œæ•´è§†å›¾
- âœ… çµæ´»å¯é…ç½®ï¼ˆå“ªäº›ä¹ æƒ¯æ˜¾ç¤ºåœ¨é¡¶éƒ¨ï¼‰
- âœ… å¹³è¡¡äº†è§†è§‰å†²å‡»åŠ›å’Œå®ç”¨æ€§

**ç¼ºç‚¹**:
- âŒ å®ç°å¤æ‚åº¦ä¸­ç­‰
- âŒ éœ€è¦ç»´æŠ¤ä¸¤å¥—æ¸²æŸ“é€»è¾‘
- âŒ å¯èƒ½è®©ç”¨æˆ·å›°æƒ‘ï¼ˆä¸ºä»€ä¹ˆæœ‰äº›ä¹ æƒ¯åœ¨ä¸Šé¢ï¼‰

---

## ä¸‰ã€æ¨èæ–¹æ¡ˆ

### 3.1 ç»¼åˆè¯„ä¼°

| æ–¹æ¡ˆ | è§†è§‰å†²å‡» | ç©ºé—´æ•ˆç‡ | å®ç°éš¾åº¦ | ç”¨æˆ·ä½“éªŒ | ç»¼åˆè¯„åˆ† |
|-----|---------|---------|---------|---------|---------|
| æ–¹æ¡ˆä¸€ï¼šæ··æ’å±•ç¤º | â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | 4.0 |
| æ–¹æ¡ˆäºŒï¼šç‹¬ç«‹ä¹ æƒ¯åŒºåŸŸ | â­â­â­â­â­ | â­â­â­ | â­â­â­ | â­â­â­â­â­ | 4.5 |
| æ–¹æ¡ˆä¸‰ï¼šæ—¥å†çƒ­åŠ›å›¾ | â­â­â­â­â­ | â­â­â­â­ | â­â­ | â­â­â­ | 3.5 |
| æ–¹æ¡ˆå››ï¼šæŠ˜å å¼ä¹ æƒ¯åˆ—è¡¨ | â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | 4.0 |
| æ–¹æ¡ˆäº”ï¼šæ··åˆå±•ç¤º | â­â­â­â­ | â­â­â­â­ | â­â­â­ | â­â­â­â­â­ | 4.5 |

### 3.2 æ¨èæ–¹æ¡ˆï¼šæ–¹æ¡ˆäº”ï¼ˆæ··åˆå±•ç¤ºï¼‰

#### æ¨èç†ç”±

1. **å¹³è¡¡æ€§æœ€ä½³**: æ—¢ä¿è¯äº†é‡è¦ä¹ æƒ¯çš„çªå‡ºæ˜¾ç¤ºï¼Œåˆä¸ä¼šå ç”¨è¿‡å¤šç©ºé—´
2. **ç”¨æˆ·ä½“éªŒä¼˜ç§€**: 
   - é¡¶éƒ¨å¡ç‰‡æä¾›å¿«é€Ÿæ“ä½œå…¥å£ï¼Œç¬¦åˆ"é‡è¦ä¿¡æ¯ä¼˜å…ˆ"åŸåˆ™
   - ä¸‹æ–¹åˆ—è¡¨æä¾›å®Œæ•´è§†å›¾ï¼Œæ»¡è¶³æŸ¥çœ‹æ‰€æœ‰ä¹ æƒ¯çš„éœ€æ±‚
   - å¯æŠ˜å è®¾è®¡ï¼Œç”¨æˆ·å¯æŒ‰éœ€å±•å¼€/æ”¶èµ·
3. **å®ç°å¯è¡Œæ€§é«˜**: ç»“åˆç°æœ‰ç³»ç»Ÿï¼Œæ”¹åŠ¨ç›¸å¯¹è¾ƒå°
4. **æ‰©å±•æ€§å¼º**: å¯ä»¥çµæ´»é…ç½®å“ªäº›ä¹ æƒ¯æ˜¾ç¤ºåœ¨é¡¶éƒ¨ï¼Œæ”¯æŒæœªæ¥åŠŸèƒ½æ‰©å±•
5. **ç¬¦åˆç”¨æˆ·ä¹ æƒ¯**: ç±»ä¼¼ä¸»æµåº”ç”¨çš„"ç½®é¡¶ + åˆ—è¡¨"æ¨¡å¼

#### å®æ–½å»ºè®®

**ç¬¬ä¸€é˜¶æ®µï¼ˆMVPï¼‰**:
1. å®ç°æ–¹æ¡ˆå››ï¼ˆæŠ˜å å¼ä¹ æƒ¯åˆ—è¡¨ï¼‰ä½œä¸ºåŸºç¡€
2. æ·»åŠ é‡å¤ä»»åŠ¡æ•°æ®ç»“æ„å’ŒåŸºæœ¬æ¸²æŸ“
3. å®ç°ä¹ æƒ¯å®ŒæˆçŠ¶æ€è¿½è¸ªå’Œè¿ç»­å¤©æ•°è®¡ç®—

**ç¬¬äºŒé˜¶æ®µï¼ˆå¢å¼ºï¼‰**:
1. åœ¨æ–¹æ¡ˆå››åŸºç¡€ä¸Šæ·»åŠ é¡¶éƒ¨é‡è¦ä¹ æƒ¯å¡ç‰‡ï¼ˆæ–¹æ¡ˆäº”ï¼‰
2. æ·»åŠ ä¹ æƒ¯ä¼˜å…ˆçº§è®¾ç½®
3. ä¼˜åŒ–å¡ç‰‡äº¤äº’å’ŒåŠ¨ç”»æ•ˆæœ

**ç¬¬ä¸‰é˜¶æ®µï¼ˆé«˜çº§åŠŸèƒ½ï¼‰**:
1. æ·»åŠ ä¹ æƒ¯ç»Ÿè®¡é¢æ¿ï¼ˆç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…ï¼‰
2. æ·»åŠ å‘¨è§†å›¾/æœˆè§†å›¾åˆ‡æ¢
3. æ·»åŠ ä¹ æƒ¯æé†’åŠŸèƒ½

### 3.3 å¤‡é€‰æ–¹æ¡ˆï¼šæ–¹æ¡ˆäºŒï¼ˆç‹¬ç«‹ä¹ æƒ¯åŒºåŸŸï¼‰

å¦‚æœç”¨æˆ·æ›´æ³¨é‡ä¹ æƒ¯è¿½è¸ªçš„è§†è§‰ä½“éªŒï¼Œå¯ä»¥è€ƒè™‘æ–¹æ¡ˆäºŒã€‚é€‚åˆä»¥ä¸‹åœºæ™¯ï¼š
- ä¹ æƒ¯è¿½è¸ªæ˜¯æ ¸å¿ƒåŠŸèƒ½
- ç”¨æˆ·ä¹ æƒ¯æ•°é‡è¾ƒå¤šï¼ˆ5+ï¼‰
- å¸Œæœ›æä¾›ä¸°å¯Œçš„ç»Ÿè®¡å’Œå¯è§†åŒ–

---

## å››ã€æŠ€æœ¯å®ç°è¦ç‚¹

### 4.1 æ•°æ®å­˜å‚¨

```javascript
// å­˜å‚¨ç»“æ„ï¼ˆæ‰©å±•ç°æœ‰ memosï¼‰
{
    memos: [
        {
            // ... ç°æœ‰å­—æ®µ
            recurrence: {
                enabled: true,
                type: 'daily',
                // ...
            },
            habit: {
                streak: 7,
                bestStreak: 14,
                completedDates: [],
                totalCompletions: 45
            },
            habitPriority: 'high'  // ç”¨äºå†³å®šæ˜¯å¦æ˜¾ç¤ºåœ¨é¡¶éƒ¨
        }
    ]
}
```

### 4.2 æ¯æ—¥ä»»åŠ¡æ›´æ–°é€»è¾‘

```javascript
/**
 * æ¯æ—¥å‡Œæ™¨æ›´æ–°é‡å¤ä»»åŠ¡
 */
async function updateDailyRecurringTasks() {
    const today = this.getTodayDate();
    
    for (const task of this.memos) {
        if (!task.recurrence?.enabled) continue;
        
        if (task.recurrence.type === 'daily') {
            // æ›´æ–°æˆªæ­¢æ—¥æœŸä¸ºä»Šå¤©
            task.dueDate = today;
            task.completed = false;
            
            // æ£€æŸ¥æ˜¨å¤©æ˜¯å¦å®Œæˆï¼Œæ›´æ–°è¿ç»­å¤©æ•°
            const yesterday = this.getDateString(new Date(Date.now() - 86400000));
            if (!task.habit.completedDates.includes(yesterday)) {
                // è¿ç»­å¤©æ•°é‡ç½®
                task.habit.streak = 0;
            }
            
            await this.saveTask(task);
        }
    }
}

// ä½¿ç”¨ chrome.alarms åœ¨æ¯å¤©00:00è§¦å‘
chrome.alarms.create('updateDailyTasks', {
    when: getNextMidnight(),
    periodInMinutes: 24 * 60
});
```

### 4.3 è¿ç»­å¤©æ•°è®¡ç®—

```javascript
/**
 * è®¡ç®—è¿ç»­å®Œæˆå¤©æ•°
 */
calculateStreak(completedDates) {
    if (!completedDates || completedDates.length === 0) return 0;
    
    // æŒ‰æ—¥æœŸæ’åºï¼ˆé™åºï¼‰
    const sorted = [...completedDates]
        .map(d => new Date(d))
        .sort((a, b) => b - a);
    
    let streak = 0;
    let expectedDate = new Date();
    expectedDate.setHours(0, 0, 0, 0);
    
    for (const completedDate of sorted) {
        completedDate.setHours(0, 0, 0, 0);
        
        if (completedDate.getTime() === expectedDate.getTime()) {
            streak++;
            expectedDate.setDate(expectedDate.getDate() - 1);
        } else {
            break;
        }
    }
    
    return streak;
}
```

### 4.4 æ€§èƒ½ä¼˜åŒ–

1. **æ‡’åŠ è½½**: ä¹ æƒ¯ç»Ÿè®¡é¢æ¿æŒ‰éœ€åŠ è½½
2. **ç¼“å­˜**: ç¼“å­˜è®¡ç®—ç»“æœï¼ˆè¿ç»­å¤©æ•°ã€å®Œæˆç‡ç­‰ï¼‰
3. **é˜²æŠ–**: å®Œæˆæ“ä½œä½¿ç”¨é˜²æŠ–ï¼Œé¿å…é¢‘ç¹ä¿å­˜
4. **è™šæ‹Ÿæ»šåŠ¨**: å¦‚æœä¹ æƒ¯æ•°é‡å¾ˆå¤šï¼Œä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨

---

## äº”ã€æ€»ç»“

æœ¬æ¬¡è°ƒç ”é€šè¿‡åˆ†æä¸»æµä»»åŠ¡ç®¡ç†å·¥å…·ã€GitHubå¼€æºé¡¹ç›®å’ŒChromeæ‰©å±•æ¡ˆä¾‹ï¼Œæ€»ç»“å‡º5ç§å¯è¡Œçš„å±•ç¤ºæ–¹æ¡ˆã€‚**æ¨èé‡‡ç”¨æ–¹æ¡ˆäº”ï¼ˆæ··åˆå±•ç¤ºï¼‰**ï¼Œå®ƒå¹³è¡¡äº†è§†è§‰å†²å‡»åŠ›ã€ç©ºé—´æ•ˆç‡å’Œå®ç°éš¾åº¦ï¼Œæœ€é€‚åˆå½“å‰é¡¹ç›®çš„éœ€æ±‚ã€‚

å…³é”®è®¾è®¡åŸåˆ™ï¼š
1. **æ¸è¿›å¼å±•ç¤º**: é‡è¦ä¿¡æ¯ä¼˜å…ˆï¼Œè¯¦ç»†ä¿¡æ¯æŒ‰éœ€å±•å¼€
2. **è§†è§‰åé¦ˆ**: é€šè¿‡é¢œè‰²ã€å›¾æ ‡ã€è¿›åº¦ç­‰æä¾›å³æ—¶åé¦ˆ
3. **æ“ä½œä¾¿æ·**: å‡å°‘æ“ä½œæ­¥éª¤ï¼Œæé«˜å®Œæˆæ•ˆç‡
4. **æ•°æ®é©±åŠ¨**: é€šè¿‡ç»Ÿè®¡æ•°æ®å¢å¼ºç”¨æˆ·æˆå°±æ„Ÿ

ä¸‹ä¸€æ­¥å»ºè®®ï¼š
1. å…ˆå®ç°æ–¹æ¡ˆå››ä½œä¸ºMVP
2. æ”¶é›†ç”¨æˆ·åé¦ˆ
3. æ ¹æ®åé¦ˆå†³å®šæ˜¯å¦å‡çº§åˆ°æ–¹æ¡ˆäº”æˆ–æ–¹æ¡ˆäºŒ

---

**è°ƒç ”å®Œæˆæ—¥æœŸ**: 2026-02-07  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**ç»´æŠ¤è€…**: AI Assistant
